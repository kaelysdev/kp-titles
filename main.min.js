var jsonSave,totalCount,isAdultKey="kp-title-is-adult",isDarkThemeKey="kp-title-is-dark-theme",saveKey="kp-title-save";function isAdult(){window.localStorage.getItem(isAdultKey)||new bootstrap.Modal(document.getElementById("adultModal")).show()}function isDarkTheme(){window.localStorage.getItem(isDarkThemeKey)&&toggleMode()}function isAdultConfirmed(){window.localStorage.setItem(isAdultKey,!0)}function prepareSave(){var e=window.localStorage.getItem(saveKey);jsonSave=e?JSON.parse(e):{}}function save(){save&&window.localStorage.setItem(saveKey,JSON.stringify(jsonSave))}function toggleMode(){$("body").toggleClass("dark"),$("#titles").toggleClass("table-dark"),$("body").hasClass("dark")?window.localStorage.setItem(isDarkThemeKey,!0):window.localStorage.removeItem(isDarkThemeKey)}function filter(){var e=$(this).prop("id");if("search"!==e&&$(`.filter:not(#${e})`).prop("checked",!1),$("tbody").show(),$("table").unmark(),$(".filter:checked").length>0){var t=$(".filter:checked").prop("id").replace("filter","");$("tbody").filter((function(){let e=$(this).data("categories");return!e||!e.includes(t)})).hide()}var a=$("#search").val();if(a&&a.length>=1){var i=a.toLowerCase();$("table").mark(i),$("tbody:visible").filter((function(){var e=$(this).find(".search-name").text().toLowerCase(),t=$(this).find(".search-description").text().toLowerCase(),a=$(this).find(".search-passives").text().toLowerCase(),n=$(this).find(".search-actives").text().toLowerCase();return!(e.includes(i)||t.includes(i)||a.includes(i)||n.includes(i))})).hide()}updateCount()}function claimed(){var e=$(this).prop("id").replace("claimed","");$(this).is(":checked")?($(this).parent().parent().parent().addClass("claimed-bg"),jsonSave[e]=!0,save()):($(this).parent().parent().parent().removeClass("claimed-bg"),jsonSave[e]=!1,save()),updateCount()}function claimedOption(){var e=$(this).prop("id").replace("claimedOption",""),t=$(`.claimed-option:not(#${$(this).prop("id")})`),a=[];$.each(t,(function(e,t){a.push($(t).prop("id").replace("claimedOption",""))})),t.prop("checked",!1).parent().parent().parent().removeClass("claimed-bg").addClass("unclaimable-bg"),$(this).parent().parent().parent().removeClass("unclaimable-bg").addClass("claimed-bg"),jsonSave[e]=!0,$.each(a,(function(e,t){jsonSave[t]=!1})),save(),updateCount()}function updateCount(){let e=$(".claimed:visible:checked, .claimed-option:visible:checked").length,t=$("tbody:visible").length;$("#filteredClaimedCount").text(e),$("#filteredCount").text(t),t<totalCount?$("#filteredCount").addClass("orange"):$("#filteredCount").removeClass("orange")}function initClaimed(){var e=!1;if($.each($(".claimed-td"),(function(t,a){$(this).parent().parent().removeClass("claimed-bg");var i=$(this).data("id");if(i>=6&&i<=11){var n=$(this).find("input");if(jsonSave)jsonSave[i]&&$(n).prop("checked",!0);n.is(":checked")&&($(this).parent().parent().addClass("claimed-bg"),e=!0)}else{var s=$(this).find("input");if(jsonSave)jsonSave[i]&&$(s).prop("checked",!0);s.is(":checked")&&$(this).parent().parent().addClass("claimed-bg")}})),e)$(".claimed-option:not(:checked)").parent().parent().parent().addClass("unclaimable-bg")}function initTable(){$.each(titles,(function(e,t){var a=`\n            <tbody data-categories="${t.categories?t.categories.toString():""}">\n                <tr>`;t.id>=6&&t.id<=11?a+=`\n                    <td rowspan="3" class="align-middle text-center border-bottom-td claimed-td" style="min-width: 45px; width: 45px;" data-id="${t.id}">\n                        <input class="form-check-input claimed-option" type="radio" name="option" value="" id="claimedOption${t.id}">\n                    </td>`:a+=`\n                    <td rowspan="3" class="align-middle text-center border-bottom-td claimed-td" style="min-width: 45px; width: 45px;" data-id="${t.id}">\n                        <input class="form-check-input claimed" type="checkbox" value="" id="claimed${t.id}"${2===t.id||3===t.id?" checked disabled":""}>\n                    </td>`,a+=`\n                    <td style="min-width: 150px; width: 150px;">${t.id}</td>\n                    <td class="title-name search-name" style="min-width: 350px; width: 350px;">${t.name}</td>\n                    <td class="search-description">${t.description}</td>\n                </tr>\n                <tr class="passive-tr">\n                    <td>Passives</td>\n                    <td class="search-passives" colspan="2">`;var i="";$.each(t.effects.passives,(function(e,t){e>0&&(i+='<span class="ms-4">'),i+=t,e>0&&(i+="</span>")})),a+=i,a+='\n                    </td>\n                </tr>\n                <tr class="active-tr border-bottom-tr">\n                    <td>Equip Effects</td>\n                    <td class="search-actives" colspan="2">';var n="";$.each(t.effects.actives,(function(e,t){e>0&&(n+='<span class="ms-4">'),n+=t,e>0&&(n+="</span>")})),a+=n,a+="\n                    </td>\n                </tr>\n            </tbody>",$("#titles").append(a)}))}$((function(){isAdult(),isDarkTheme(),initTable(),prepareSave(),initClaimed(),$(".filter").prop("checked",!1),$("#search").val(""),totalCount=titles.length,$("#totalCount").text(totalCount),updateCount(),$(document).on("change",".filter",filter),$(document).on("input propertychange paste","#search",filter),$(document).on("click",".clear-search",(function(){$("#search").val("").focus(),filter()})),$(document).on("click",".toggle-mode",toggleMode),$(document).on("change",".claimed",claimed),$(document).on("change",".claimed-option",claimedOption)}));